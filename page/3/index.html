<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rockintuna.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="소문난">
<meta property="og:url" content="http://rockintuna.github.io/page/3/index.html">
<meta property="og:site_name" content="소문난">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Jeong In">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://rockintuna.github.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>소문난</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">소문난</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rockintuna.github.io/2020/08/12/hexo_springboot_1_17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jeong In">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="소문난">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/12/hexo_springboot_1_17/" class="post-title-link" itemprop="url">17. 프론트 엔드</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-12 21:22:41" itemprop="dateCreated datePublished" datetime="2020-08-12T21:22:41+09:00">2020-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/" itemprop="url" rel="index"><span itemprop="name">Study</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/Spring-Boot-Project/" itemprop="url" rel="index"><span itemprop="name">Spring Boot Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="스프링-부트-프로젝트"><a href="#스프링-부트-프로젝트" class="headerlink" title="스프링 부트 프로젝트"></a>스프링 부트 프로젝트</h1><h3 id="레스토랑-예약-사이트-만들기"><a href="#레스토랑-예약-사이트-만들기" class="headerlink" title="레스토랑 예약 사이트 만들기"></a>레스토랑 예약 사이트 만들기</h3><h4 id="17-프론트-엔드"><a href="#17-프론트-엔드" class="headerlink" title="17. 프론트 엔드"></a>17. 프론트 엔드</h4><p>webpack / webpack-cli / webpack-dev-server 설치</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -save-dev webpack webpack-cli webpack-dev-server</span><br></pre></td></tr></table></figure>

<p>start 추가</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;eatgo-web&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;EatGo Web Project&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;src&#x2F;index.js&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;start&quot;: &quot;webpack-dev-server --port 3000&quot;,</span><br><span class="line">    &quot;test&quot;: &quot;jest&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;author&quot;: &quot;Jeong In&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;ISC&quot;,</span><br><span class="line">  &quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;webpack&quot;: &quot;^4.43.0&quot;,</span><br><span class="line">    &quot;webpack-cli&quot;: &quot;^3.3.11&quot;,</span><br><span class="line">    &quot;webpack-dev-server&quot;: &quot;^3.11.0&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>webpack-dev-server 실행</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
<p>실제로는 아래와 같은 프로세스가 실행되어 있다   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep webpack</span><br><span class="line">                                          </span><br><span class="line">501 43162 43161   0 11:28PM ttys000    0:03.58 node &#x2F;Users&#x2F;ijeong-in&#x2F;Git_repo&#x2F;eatgo&#x2F;eatgo-web&#x2F;node_modules&#x2F;.bin&#x2F;webpack-dev-server --port 3000</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">index.html</span><br><span class="line">webpack-dev-server가 index.js를 main.js로 바꿔준다.</span><br></pre></td></tr></table></figure>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>EatGo</title>
</head>
<body>
    <div id="app"></div>
    <script src="./main.js"></script>
</body>
</html>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">index.js</span><br><span class="line">app을 가져와서 내용 고치기    </span><br><span class="line">모든 가게의 id, 이름, 주소 출력</span><br></pre></td></tr></table></figure>
(async () => {
    const url = 'http://localhost:8080/restaurants';
    const response = await fetch(url);
    const restaurants = await response.json();

<pre><code>const element = document.getElementById(&apos;app&apos;);
element.innerHTML = `
    ${restaurants.map(restaurant =&gt; `
    &lt;p&gt;
        ${restaurant.id}
        ${restaurant.name}
        ${restaurant.address}
    &lt;/p&gt;
    `).join(&apos;&apos;)}
`;</code></pre><p>})();</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">별도의 웹서버에서 CORS에 따라 서로 보안을 위해 접근할 수 없기때문에 </span><br><span class="line">Spring에서 CrossOrigin annotation 처리</span><br></pre></td></tr></table></figure>
<p>@CrossOrigin<br>@RestController<br>public class RestaurantController {</p>
<pre><code>@Autowired
private RestaurantService restaurantService;

@GetMapping(&quot;/restaurants&quot;)
public List&lt;Restaurant&gt; list() {

    List&lt;Restaurant&gt; restaurants = restaurantService.getRestaurants(); //API들의 중복제거를 위해 가게 저장소 사용
    return restaurants;
}</code></pre><pre><code></code></pre>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rockintuna.github.io/2020/08/12/hexo_springboot_1_18/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jeong In">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="소문난">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/12/hexo_springboot_1_18/" class="post-title-link" itemprop="url">18. 가게 수정</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-12 21:22:41" itemprop="dateCreated datePublished" datetime="2020-08-12T21:22:41+09:00">2020-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/" itemprop="url" rel="index"><span itemprop="name">Study</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/Spring-Boot-Project/" itemprop="url" rel="index"><span itemprop="name">Spring Boot Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="스프링-부트-프로젝트"><a href="#스프링-부트-프로젝트" class="headerlink" title="스프링 부트 프로젝트"></a>스프링 부트 프로젝트</h1><h3 id="레스토랑-예약-사이트-만들기"><a href="#레스토랑-예약-사이트-만들기" class="headerlink" title="레스토랑 예약 사이트 만들기"></a>레스토랑 예약 사이트 만들기</h3><h4 id="18-가게-수정"><a href="#18-가게-수정" class="headerlink" title="18. 가게 수정"></a>18. 가게 수정</h4><p>PATCH /restaurants/{id}<br>성공 http status 200  </p>
<p>Controller Test에서 새로운 기능 테스트    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void update() throws Exception &#123;</span><br><span class="line">    mvc.perform(patch(&quot;&#x2F;restaurants&#x2F;1&quot;)</span><br><span class="line">            .contentType(MediaType.APPLICATION_JSON)</span><br><span class="line">            .content(&quot;&#123;\&quot;name\&quot;:\&quot;GukBobZip\&quot;,\&quot;address\&quot;:\&quot;Busan\&quot;&#125;&quot;))</span><br><span class="line">            .andExpect(status().isOk());</span><br><span class="line"></span><br><span class="line">    verify(restaurantService).updateRestaurant(1L, &quot;GukBobZip&quot;, &quot;Busan&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Controller에 실제 기능 추가    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@PatchMapping(&quot;&#x2F;restaurants&#x2F;&#123;id&#125;&quot;)</span><br><span class="line">public String update(@PathVariable(&quot;id&quot;) Long id,</span><br><span class="line">                     @RequestBody Restaurant resource) &#123;</span><br><span class="line"></span><br><span class="line">    String name &#x3D; resource.getName();</span><br><span class="line">    String address &#x3D; resource.getAddress();</span><br><span class="line"></span><br><span class="line">    restaurantService.updateRestaurant(id, name, address);</span><br><span class="line">    return &quot;&#123;&#125;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Service Test</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void updateRestaurant() &#123;</span><br><span class="line"></span><br><span class="line">    Restaurant restaurant &#x3D; new Restaurant(1L, &quot;BobZip&quot;, &quot;Seoul&quot;);</span><br><span class="line">    given(restaurantRepository.findById(1L)).willReturn(java.util.Optional.of(restaurant));</span><br><span class="line"></span><br><span class="line">    restaurantService.updateRestaurant(1L,&quot;GukBobZip&quot;,&quot;Busan&quot;);</span><br><span class="line"></span><br><span class="line">    assertThat(restaurant.getName(), is(&quot;GukBobZip&quot;));</span><br><span class="line">    assertThat(restaurant.getAddress(), is(&quot;Busan&quot;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Service 추가</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Transactional &#x2F;&#x2F;트랜젝션 범위에서 처리되고 범위에서 처리가 벗어났을때 내용이 적용됨</span><br><span class="line">public Restaurant updateRestaurant(Long id, String name, String address) &#123;</span><br><span class="line">    Restaurant restaurant &#x3D; restaurantRepository.findById(id).orElse(null);</span><br><span class="line"></span><br><span class="line">    restaurant.setInformation(name,address);</span><br><span class="line">    return restaurant;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>테스트</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ http PATCH localhost:8080&#x2F;restaurants&#x2F;1 name&#x3D;BeRyong address&#x3D;Seoul</span><br><span class="line">HTTP&#x2F;1.1 200 </span><br><span class="line">~</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rockintuna.github.io/2020/08/12/hexo_springboot_1_19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jeong In">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="소문난">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/12/hexo_springboot_1_19/" class="post-title-link" itemprop="url">19. Lombok</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-12 21:22:41" itemprop="dateCreated datePublished" datetime="2020-08-12T21:22:41+09:00">2020-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/" itemprop="url" rel="index"><span itemprop="name">Study</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/Spring-Boot-Project/" itemprop="url" rel="index"><span itemprop="name">Spring Boot Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="스프링-부트-프로젝트"><a href="#스프링-부트-프로젝트" class="headerlink" title="스프링 부트 프로젝트"></a>스프링 부트 프로젝트</h1><h3 id="레스토랑-예약-사이트-만들기"><a href="#레스토랑-예약-사이트-만들기" class="headerlink" title="레스토랑 예약 사이트 만들기"></a>레스토랑 예약 사이트 만들기</h3><h4 id="19-Lombok"><a href="#19-Lombok" class="headerlink" title="19. Lombok"></a>19. Lombok</h4><p>Annotation Processor 를 이용해서 코딩 자동화</p>
<p>@Setter<br>@Getter<br>@Builder    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">@Getter &#x2F;&#x2F;모든 속성들에 대한 getter 가 알아서 만들어 진다</span><br><span class="line">@NoArgsConstructor &#x2F;&#x2F;디폴트 생성자</span><br><span class="line">@AllArgsConstructor &#x2F;&#x2F;모든 속성 조합을 사용하는 생성자들</span><br><span class="line">@Builder &#x2F;&#x2F;Builder 패턴을 사용</span><br><span class="line">public class Restaurant &#123;</span><br><span class="line">    @Id</span><br><span class="line">    @Setter</span><br><span class="line">    @GeneratedValue</span><br><span class="line">    private Long id;</span><br><span class="line">    @Setter &#x2F;&#x2F;name에 대한 setter 가 알아서 만들어 진다</span><br><span class="line">    private String name;</span><br><span class="line">    private String address;</span><br><span class="line"></span><br><span class="line">    @Transient  </span><br><span class="line">    private List&lt;MenuItem&gt; menuItems;</span><br><span class="line"></span><br><span class="line">    public String getInformation() &#123;</span><br><span class="line">        return name+&quot; in &quot;+address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setMenuItems(List&lt;MenuItem&gt; menuItems) &#123;</span><br><span class="line">        this.menuItems &#x3D; new ArrayList&lt;MenuItem&gt;(menuItems);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setInformation(String name, String address) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">        this.address &#x3D; address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Builder로 인스턴스 생성시</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void creation() &#123;</span><br><span class="line">    Restaurant restaurant &#x3D; Restaurant.builder() &#x2F;&#x2F;@Builder 패턴을 사용, 가독이 좋고 순서가 없다는 장점이 있다.  </span><br><span class="line">            .id(1004L)</span><br><span class="line">            .name(&quot;Bob zip&quot;)</span><br><span class="line">            .address(&quot;Seoul&quot;)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    assertThat(restaurant.getId(), is(1004L));</span><br><span class="line">    assertThat(restaurant.getName(), is(&quot;Bob zip&quot;));</span><br><span class="line">    assertThat(restaurant.getAddress(), is(&quot;Seoul&quot;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rockintuna.github.io/2020/08/12/hexo_springboot_1_21/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jeong In">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="소문난">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/12/hexo_springboot_1_21/" class="post-title-link" itemprop="url">21. Validation, 에러 처리</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-12 21:22:41" itemprop="dateCreated datePublished" datetime="2020-08-12T21:22:41+09:00">2020-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/" itemprop="url" rel="index"><span itemprop="name">Study</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/Spring-Boot-Project/" itemprop="url" rel="index"><span itemprop="name">Spring Boot Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="스프링-부트-프로젝트"><a href="#스프링-부트-프로젝트" class="headerlink" title="스프링 부트 프로젝트"></a>스프링 부트 프로젝트</h1><h3 id="레스토랑-예약-사이트-만들기"><a href="#레스토랑-예약-사이트-만들기" class="headerlink" title="레스토랑 예약 사이트 만들기"></a>레스토랑 예약 사이트 만들기</h3><h4 id="21-Validation-에러-처리"><a href="#21-Validation-에러-처리" class="headerlink" title="21. Validation, 에러 처리"></a>21. Validation, 에러 처리</h4><p>Validation : 유효성 검사<br>사용자들이 입력한 데이터가 올바른지 검증하는 작업이다.  </p>
<p>@Valid</p>
<p>@NotNull<br>@NotEmpty<br>@Size(max=10)</p>
<p>올바르지 않을 시 Error(http status 400)를 리턴하도록</p>
<p>Controller의 기능에 @Valid 추가   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@PostMapping(&quot;&#x2F;restaurants&quot;)</span><br><span class="line">public ResponseEntity&lt;?&gt; create(@Valid @RequestBody Restaurant resource) &#x2F;&#x2F;Valid: 검증할 것이라 정의</span><br><span class="line">        throws URISyntaxException &#123;</span><br><span class="line"></span><br><span class="line">            Restaurant restaurant &#x3D; Restaurant.builder()</span><br><span class="line">            .name(resource.getName())</span><br><span class="line">            .address(resource.getAddress())</span><br><span class="line">            .build();</span><br><span class="line">    restaurantService.addRestaurant(restaurant);</span><br><span class="line"></span><br><span class="line">    URI location &#x3D; new URI(&quot;&#x2F;restaurants&#x2F;&quot;+restaurant.getId());</span><br><span class="line">    return ResponseEntity.created(location).body(&quot;&#123;&#125;&quot;); &#x2F;&#x2F;빈 내용</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@PatchMapping(&quot;&#x2F;restaurants&#x2F;&#123;id&#125;&quot;)</span><br><span class="line">public String update(@PathVariable(&quot;id&quot;) Long id,</span><br><span class="line">                     @Valid @RequestBody Restaurant resource) &#123;</span><br><span class="line"></span><br><span class="line">    restaurantService.updateRestaurant(id, resource.getName(), resource.getAddress());</span><br><span class="line">    return &quot;&#123;&#125;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Model에서 속성 특징 변경</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@NotEmpty &#x2F;&#x2F;비어있으면 안된다고 정의</span><br><span class="line">private String name;</span><br><span class="line">@NotEmpty</span><br><span class="line">private String address;</span><br></pre></td></tr></table></figure>

<p>Controller Test</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void createWithInvalidData() throws Exception &#123;</span><br><span class="line">    mvc.perform(post(&quot;&#x2F;restaurants&quot;)</span><br><span class="line">            .contentType(MediaType.APPLICATION_JSON)</span><br><span class="line">            .content(&quot;&#123;\&quot;name\&quot;:\&quot;\&quot;,\&quot;address\&quot;:\&quot;\&quot;&#125;&quot;))</span><br><span class="line">            .andExpect(status().isBadRequest());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">public void updateWithInvalidData() throws Exception &#123;</span><br><span class="line">    mvc.perform(patch(&quot;&#x2F;restaurants&#x2F;1&quot;)</span><br><span class="line">            .contentType(MediaType.APPLICATION_JSON)</span><br><span class="line">            .content(&quot;&#123;\&quot;name\&quot;:\&quot;\&quot;,\&quot;address\&quot;:\&quot;\&quot;&#125;&quot;))</span><br><span class="line">            .andExpect(status().isBadRequest());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Not Found에 대한 처리 =&gt; Exception (http status 404)<br>ex) 없는 URL</p>
<p>@ControllerAdvice : 예외를 받아 처리할 클래스  </p>
<p>Demo<br>존재하지 않는 id의 가게를 조회했을 때 http status 404를 response하려면</p>
<p>id:404(없는 id)의 디테일을 Get했을때 not found를 받고싶다.  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    @Test</span><br><span class="line">    public void detailWithNotExist() throws Exception &#123;</span><br><span class="line">        given(restaurantService.getRestaurant(404L))</span><br><span class="line">                .willThrow(new RestaurantNotFoundException(404L)); &#x2F;&#x2F;서비스는 사용자 예외를 던질건데  </span><br><span class="line"></span><br><span class="line">        mvc.perform(MockMvcRequestBuilders.get(&quot;&#x2F;restaurants&#x2F;404&quot;))</span><br><span class="line">                .andExpect(status().isNotFound()) &#x2F;&#x2F;status 404인지 확인하고싶다.</span><br><span class="line">                .andExpect(content().string(&quot;&#123;&#125;&quot;)); &#x2F;&#x2F;빈 body도 받는지 확인하고싶다.  </span><br><span class="line">    &#125;</span><br><span class="line">&#96;&#96;&#96;  </span><br><span class="line"></span><br><span class="line">사용자 예외 클래스 생성</span><br></pre></td></tr></table></figure>
<p>public class RestaurantNotFoundException extends RuntimeException {</p>
<pre><code>public RestaurantNotFoundException(long id) {
    super(&quot;Could not find restaurant &quot;+id); //RuntimeException의 매개변수 massage(String)
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Controller에서 try&#x2F;catch로 예외처리 해줄수도 있겠지만  </span><br><span class="line">예외처리를 맡아줄 ControllerAdvice를 생성해준다.</span><br></pre></td></tr></table></figure>
<p>@ControllerAdvice //예외를 처리할 클래스<br>public class RestaurantErrorAdvice {</p>
<pre><code>@ResponseBody
@ResponseStatus(HttpStatus.NOT_FOUND) //response 404 할것임
@ExceptionHandler(RestaurantNotFoundException.class) //어떤 예외에 대한 정의
public String handleNotFound() {
    return &quot;{}&quot;; //예외 처리하고 비어있는 body를 보낼것이다.
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Service에서도 test 진행</span><br></pre></td></tr></table></figure>
<pre><code>@Test(expected = RestaurantNotFoundException.class) //사용자 예외가 발생할까?  
public void getRestaurantWithNotExisted() {

    Restaurant restaurant = restaurantService.getRestaurant(404L);
}</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">orElseThrow()로 예외 처리</span><br></pre></td></tr></table></figure>
<pre><code>public Restaurant getRestaurant(Long id) {

    Restaurant restaurant =  restaurantRepository.findById(id)
            .orElseThrow(() -&gt; new RestaurantNotFoundException(id)); //사용자 예외 처리
    List&lt;MenuItem&gt; menuItems = menuItemRepository.findAllByRestaurantId(id);
    restaurant.setMenuItems(menuItems);

    return restaurant;
}</code></pre><pre><code></code></pre>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rockintuna.github.io/2020/08/12/hexo_springboot_1_23/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jeong In">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="소문난">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/12/hexo_springboot_1_23/" class="post-title-link" itemprop="url">23. 메뉴 관리</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-12 21:22:41" itemprop="dateCreated datePublished" datetime="2020-08-12T21:22:41+09:00">2020-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/" itemprop="url" rel="index"><span itemprop="name">Study</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/Spring-Boot-Project/" itemprop="url" rel="index"><span itemprop="name">Spring Boot Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="스프링-부트-프로젝트"><a href="#스프링-부트-프로젝트" class="headerlink" title="스프링 부트 프로젝트"></a>스프링 부트 프로젝트</h1><h3 id="레스토랑-예약-사이트-만들기"><a href="#레스토랑-예약-사이트-만들기" class="headerlink" title="레스토랑 예약 사이트 만들기"></a>레스토랑 예약 사이트 만들기</h3><h4 id="23-메뉴-관리"><a href="#23-메뉴-관리" class="headerlink" title="23. 메뉴 관리"></a>23. 메뉴 관리</h4><p>메뉴 관리 : 추가 수정 삭제 기능 추가</p>
<p>한번에 여러게 업데이트 : Bulk Update<br>Patch “/restaurants/{id}/menuitems”<br>http status : 200</p>
<p>restaurant은 추가할때 save(), 수정할때 @Transactional으로 직접 수정했었는데,<br>메뉴는 Bulk Update를 할거고 save()와 deleteById()를 동시에 사용할 것임.  </p>
<p>MenuItem Controller Test</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void bulkUpdate() throws Exception &#123;</span><br><span class="line">    mvc.perform(patch(&quot;&#x2F;restaurants&#x2F;1&#x2F;menuitems&quot;) &#x2F;&#x2F;1번 가게의 menuitem을 bulk로 수정할껀데</span><br><span class="line">            .contentType(MediaType.APPLICATION_JSON) &#x2F;&#x2F;헤더에 content-Type이 Application&#x2F;json 이고</span><br><span class="line">            .content(&quot;[\n&quot; +</span><br><span class="line">                    &quot;  &#123;\n&quot; +</span><br><span class="line">                    &quot;    \&quot;name\&quot;: \&quot;Kimchi\&quot;\n&quot; +</span><br><span class="line">                    &quot;  &#125;,\n&quot; +</span><br><span class="line">                    &quot;  &#123;\n&quot; +</span><br><span class="line">                    &quot;    \&quot;name\&quot;: \&quot;Gukbob\&quot;\n&quot; +</span><br><span class="line">                    &quot;  &#125;\n&quot; +</span><br><span class="line">                    &quot;]&quot;)) &#x2F;&#x2F;이런 array를 입력할꺼야</span><br><span class="line">            .andExpect(status().isOk()); &#x2F;&#x2F;http status 200이야?</span><br><span class="line">            </span><br><span class="line">    verify(menuItemServices).bulkUpdate(eq(1L), any()); &#x2F;&#x2F;서비스에서 bulkUpdate()가 올바른 id(1L)로 호출되나?</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Controller에 PatchMapping 추가</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@PatchMapping(&quot;&#x2F;restaurants&#x2F;&#123;restaurantId&#125;&#x2F;menuitems&quot;)</span><br><span class="line">public void bulkUpdate(</span><br><span class="line">        @PathVariable(&quot;restaurantId&quot;) Long restaurantId,</span><br><span class="line">        @RequestBody List&lt;MenuItem&gt; menuItems &#x2F;&#x2F;MenuItem List를 사용자로부터 입력받는다. </span><br><span class="line">) &#123;</span><br><span class="line">    menuItemServices.bulkUpdate(restaurantId, menuItems);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>Service 테스트</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">@Mock</span><br><span class="line">private MenuItemRepository menuItemRepository;</span><br><span class="line"></span><br><span class="line">@Before</span><br><span class="line">public void setUp() &#123;</span><br><span class="line">    MockitoAnnotations.initMocks(this);</span><br><span class="line">    menuItemServices &#x3D; new MenuItemService(menuItemRepository);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">public void bulkUpdate() &#123;</span><br><span class="line">    </span><br><span class="line">    List&lt;MenuItem&gt; menuItems &#x3D; new ArrayList&lt;MenuItem&gt;();</span><br><span class="line">    </span><br><span class="line">    menuItems.add(MenuItem.builder().name(&quot;Kimchi&quot;).build()); &#x2F;&#x2F;add</span><br><span class="line">    menuItems.add(MenuItem.builder().id(12L).name(&quot;Gukbob&quot;).build()); &#x2F;&#x2F;add</span><br><span class="line">    menuItems.add(MenuItem.builder().id(1004L).destroy(true).build()); &#x2F;&#x2F;delete</span><br><span class="line">    menuItems.add(MenuItem.builder().id(12L).name(&quot;Guk Bob&quot;).build()); &#x2F;&#x2F;update</span><br><span class="line"></span><br><span class="line">    menuItemServices.bulkUpdate(1L,menuItems);</span><br><span class="line"></span><br><span class="line">    verify(menuItemRepository, times(3)).save(any()); &#x2F;&#x2F;save 함수가 3회 호출되나?</span><br><span class="line">    verify(menuItemRepository, times(1)).deleteById(1004L); &#x2F;&#x2F;deleteById 함수가 1회 호출되나?</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Restaurant Model의 menuItem이 안보이게 수정 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@Transient</span><br><span class="line">@JsonInclude(JsonInclude.Include.NON_NULL) &#x2F;&#x2F;Null이 아닐때만 json에 넣어줘라</span><br><span class="line">private List&lt;MenuItem&gt; menuItems;</span><br></pre></td></tr></table></figure>

<p>MenuItem Model에 destory라는 속성 추가</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@Transient</span><br><span class="line">@JsonInclude(JsonInclude.Include.NON_DEFAULT) &#x2F;&#x2F;json에 포함 X</span><br><span class="line">private boolean destroy;</span><br></pre></td></tr></table></figure>

<p>Service</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class MenuItemService &#123;</span><br><span class="line"></span><br><span class="line">    private MenuItemRepository menuItemRepository;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    public MenuItemService(MenuItemRepository menuItemRepository) &#123;</span><br><span class="line">        this.menuItemRepository&#x3D;menuItemRepository;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public void bulkUpdate(Long restaurantId, List&lt;MenuItem&gt; menuItems) &#123;</span><br><span class="line"></span><br><span class="line">        for(MenuItem menuItem : menuItems) &#123;</span><br><span class="line">            update(restaurantId, menuItem);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void update(Long restaurantId, MenuItem menuItem) &#123;</span><br><span class="line">        if (menuItem.isDestroy()) &#123;</span><br><span class="line">            menuItemRepository.deleteById(menuItem.getId());</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        menuItem.setRestaurantId(restaurantId);</span><br><span class="line">        menuItemRepository.save(menuItem);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rockintuna.github.io/2020/08/12/hexo_springboot_1_26/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jeong In">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="소문난">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/12/hexo_springboot_1_26/" class="post-title-link" itemprop="url">26. 리뷰 작성</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-12 21:22:41" itemprop="dateCreated datePublished" datetime="2020-08-12T21:22:41+09:00">2020-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/" itemprop="url" rel="index"><span itemprop="name">Study</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/Spring-Boot-Project/" itemprop="url" rel="index"><span itemprop="name">Spring Boot Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="스프링-부트-프로젝트"><a href="#스프링-부트-프로젝트" class="headerlink" title="스프링 부트 프로젝트"></a>스프링 부트 프로젝트</h1><h3 id="레스토랑-예약-사이트-만들기"><a href="#레스토랑-예약-사이트-만들기" class="headerlink" title="레스토랑 예약 사이트 만들기"></a>레스토랑 예약 사이트 만들기</h3><h4 id="26-리뷰-작성"><a href="#26-리뷰-작성" class="headerlink" title="26. 리뷰 작성"></a>26. 리뷰 작성</h4><p>POST /restaurants/{id}/reviews</p>
<p>Review Controller Test</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">@RunWith(SpringRunner.class)</span><br><span class="line">@WebMvcTest(ReviewController.class)</span><br><span class="line">public class ReviewControllerTest &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private MockMvc mvc;</span><br><span class="line"></span><br><span class="line">    @MockBean</span><br><span class="line">    private ReviewService reviewService;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void createWithValidAttributes() throws Exception &#123;</span><br><span class="line">        given(reviewService.addReview(any(),eq(1L))).willReturn(</span><br><span class="line">                Review.builder().id(1004L).build()</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        mvc.perform(post(&quot;&#x2F;restaurants&#x2F;1&#x2F;reviews&quot;)</span><br><span class="line">                .contentType(MediaType.APPLICATION_JSON) &#x2F;&#x2F;json 타입이고</span><br><span class="line">                .content(&quot;&#123;\&quot;name\&quot;:\&quot;jilee\&quot;,\&quot;score\&quot;:3,\&quot;description\&quot;:\&quot;Mat-it-da\&quot;&#125;&quot;)) &#x2F;&#x2F;이렇게 넣을거야</span><br><span class="line">                .andExpect(status().isCreated()) &#x2F;&#x2F;잘 만들어지나?(status 201?)</span><br><span class="line">                .andExpect(header().string(&quot;location&quot;, &quot;&#x2F;restaurants&#x2F;1&#x2F;reviews&#x2F;1004&quot;)); &#x2F;&#x2F;header의 location 확인</span><br><span class="line"></span><br><span class="line">        verify(reviewService).addReview(any(),eq(1L)); &#x2F;&#x2F;addReview가 호출되니?</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void createWithInValidAttributes() throws Exception &#123;</span><br><span class="line">        mvc.perform(post(&quot;&#x2F;restaurants&#x2F;1&#x2F;reviews&quot;)</span><br><span class="line">                .contentType(MediaType.APPLICATION_JSON) &#x2F;&#x2F;json 타입이고</span><br><span class="line">                .content(&quot;&#123;&#125;&quot;)) &#x2F;&#x2F;이렇게 넣을거야</span><br><span class="line">                .andExpect(status().isBadRequest()); &#x2F;&#x2F;status 404?</span><br><span class="line"></span><br><span class="line">        verify(reviewService,never()).addReview(any(),eq(1L)); &#x2F;&#x2F;addReview가 호출되지 않니?</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Review Controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class ReviewController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private ReviewService reviewService;</span><br><span class="line"></span><br><span class="line">    @PostMapping(&quot;&#x2F;restaurants&#x2F;&#123;restaurantId&#125;&#x2F;reviews&quot;)</span><br><span class="line">    public ResponseEntity&lt;?&gt; create(</span><br><span class="line">            @PathVariable(&quot;restaurantId&quot;) Long restaurantId,</span><br><span class="line">            @Valid @RequestBody Review resource</span><br><span class="line">    ) throws URISyntaxException &#123;</span><br><span class="line"></span><br><span class="line">        Review review &#x3D; reviewService.addReview(resource,restaurantId);</span><br><span class="line"></span><br><span class="line">        String url &#x3D; &quot;&#x2F;restaurants&#x2F;&quot;+restaurantId+&quot;&#x2F;reviews&#x2F;&quot;+review.getId();</span><br><span class="line">        return ResponseEntity.created(new URI(url))</span><br><span class="line">                .body(&quot;&#123;&#125;&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Service Test</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public class ReviewServiceTest &#123;</span><br><span class="line"></span><br><span class="line">    private ReviewService reviewService;</span><br><span class="line"></span><br><span class="line">    @Mock</span><br><span class="line">    private ReviewRepository reviewRepository;</span><br><span class="line"></span><br><span class="line">    @Before</span><br><span class="line">    public void setUp() &#123;</span><br><span class="line">        MockitoAnnotations.initMocks(this);</span><br><span class="line"></span><br><span class="line">        reviewService &#x3D; new ReviewService(reviewRepository);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void addReview() &#123;</span><br><span class="line">        Review review &#x3D; Review.builder().name(&quot;jilee&quot;).score(3).description(&quot;Mat-it-da&quot;).build(); &#x2F;&#x2F;Review 객체 생성</span><br><span class="line">        reviewService.addReview(review,1004L); &#x2F;&#x2F;기능 실행할때</span><br><span class="line"></span><br><span class="line">        verify(reviewRepository).save(any()); &#x2F;&#x2F;save가 호출되니?</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Service</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class ReviewService &#123;</span><br><span class="line"></span><br><span class="line">    private ReviewRepository reviewRepository;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    public ReviewService(ReviewRepository reviewRepository) &#123;</span><br><span class="line">        this.reviewRepository &#x3D; reviewRepository;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Review addReview(Review review,Long restaurantId) &#123;</span><br><span class="line">        review.setRestaurantId(restaurantId);</span><br><span class="line">        return reviewRepository.save(review);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Review Repository</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface ReviewRepository extends CrudRepository&lt;Review, Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">    Review save(Review review);</span><br><span class="line"></span><br><span class="line">    List&lt;Review&gt; findAllByRestaurantId(Long restaurantId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rockintuna.github.io/2020/08/12/hexo_springboot_1_29/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jeong In">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="소문난">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/12/hexo_springboot_1_29/" class="post-title-link" itemprop="url">29. 프로젝트 분리</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-12 21:22:41" itemprop="dateCreated datePublished" datetime="2020-08-12T21:22:41+09:00">2020-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/" itemprop="url" rel="index"><span itemprop="name">Study</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/Spring-Boot-Project/" itemprop="url" rel="index"><span itemprop="name">Spring Boot Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="스프링-부트-프로젝트"><a href="#스프링-부트-프로젝트" class="headerlink" title="스프링 부트 프로젝트"></a>스프링 부트 프로젝트</h1><h3 id="레스토랑-예약-사이트-만들기"><a href="#레스토랑-예약-사이트-만들기" class="headerlink" title="레스토랑 예약 사이트 만들기"></a>레스토랑 예약 사이트 만들기</h3><h4 id="29-프로젝트-분리"><a href="#29-프로젝트-분리" class="headerlink" title="29. 프로젝트 분리"></a>29. 프로젝트 분리</h4><p>./gradlew build<br>./gradlew assamble<br>./gradlew test //전체 테스트 실행<br>./gradlew check  </p>
<p>사용자에 따른 API 분리  </p>
<p>기존 settings.gradle</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rootProject.name &#x3D; &#39;eatgo&#39;</span><br><span class="line"></span><br><span class="line">include &#39;eatgo-api&#39;</span><br></pre></td></tr></table></figure>
<p>변경 후 settings.gradle<br>eatgo-common : 공동으로 사용될 package들 (domain)<br>eatgo-admin-api : 가게 관리자용<br>eatgo-customer-api : 고객용    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rootProject.name &#x3D; &#39;eatgo&#39;</span><br><span class="line"></span><br><span class="line">include &#39;eatgo-common&#39;</span><br><span class="line">include &#39;eatgo-admin-api&#39;</span><br><span class="line">include &#39;eatgo-customer-api&#39;</span><br></pre></td></tr></table></figure>

<p>eatgo-common의 build.gradle 수정<br>참고 : <a href="https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/html/#packaging-executable-and-normal" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/html/#packaging-executable-and-normal</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jar &#123; </span><br><span class="line">    enabled &#x3D; true &#x2F;&#x2F;default가 false이기때문에, false면 import에서 문제 발생  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bootJar &#123;</span><br><span class="line">    enabled &#x3D; false &#x2F;&#x2F;true면 gradle assamble&#x2F;build 에서 문제발생 </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>eatgo-admin-api, eatgo-customer-api의 build.gradle 수정<br>eatgo-common 의존성 추가  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">	implementation project(&#39;:eatgo-common&#39;)</span><br><span class="line"></span><br><span class="line">    ~</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rockintuna.github.io/2020/08/12/hexo_springboot_1_34/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jeong In">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="소문난">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/12/hexo_springboot_1_34/" class="post-title-link" itemprop="url">34. 진짜 영속화</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-12 21:22:41" itemprop="dateCreated datePublished" datetime="2020-08-12T21:22:41+09:00">2020-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/" itemprop="url" rel="index"><span itemprop="name">Study</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/Spring-Boot-Project/" itemprop="url" rel="index"><span itemprop="name">Spring Boot Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="스프링-부트-프로젝트"><a href="#스프링-부트-프로젝트" class="headerlink" title="스프링 부트 프로젝트"></a>스프링 부트 프로젝트</h1><h3 id="레스토랑-예약-사이트-만들기"><a href="#레스토랑-예약-사이트-만들기" class="headerlink" title="레스토랑 예약 사이트 만들기"></a>레스토랑 예약 사이트 만들기</h3><h4 id="34-진짜-영속화"><a href="#34-진짜-영속화" class="headerlink" title="34. 진짜 영속화"></a>34. 진짜 영속화</h4><p>database(h2)를 이제부터 file로 생성할 예정이다.<br>file을 사용하게 되면 test에 실행되는 내용도 file에 작성될 수 있기때문에<br>test, 개발, 서비스 등 다른 영역에서 각각 다른 설정으로 처리될 수 있도록 profiles를 사용한다.    </p>
<p>eatgo-admin-api &amp; eatgo-customer-api<br>resource에 application.yml 파일 추가</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">##spring:</span><br><span class="line">##  key: value</span><br><span class="line">spring:</span><br><span class="line">  datasource:</span><br><span class="line">    url: jdbc:h2:~&#x2F;data&#x2F;eatgo</span><br><span class="line">  jpa:</span><br><span class="line">    hibernate:</span><br><span class="line">      ddl-auto: update</span><br><span class="line">      </span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">spring:</span><br><span class="line">  profiles: test</span><br><span class="line">  datasource:</span><br><span class="line">    url: jdbc:h2:mem:test</span><br></pre></td></tr></table></figure>

<p>여러개의 설정을 나누려면 ‘—‘<br>SPRING_PROFILES_ACTIVE=test 일때, profiles: test의 설정이 적용된다.<br>ex) SPRING_PROFILES_ACTIVE=test ./gradlew test<br>intellij에서는 Test edit configuration에서 Environment value에 추가해주면 된다.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rockintuna.github.io/2020/08/12/hexo_springboot_1_35/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jeong In">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="소문난">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/12/hexo_springboot_1_35/" class="post-title-link" itemprop="url">35. 가게 목록 필터링</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-12 21:22:41" itemprop="dateCreated datePublished" datetime="2020-08-12T21:22:41+09:00">2020-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/" itemprop="url" rel="index"><span itemprop="name">Study</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/Spring-Boot-Project/" itemprop="url" rel="index"><span itemprop="name">Spring Boot Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="스프링-부트-프로젝트"><a href="#스프링-부트-프로젝트" class="headerlink" title="스프링 부트 프로젝트"></a>스프링 부트 프로젝트</h1><h3 id="레스토랑-예약-사이트-만들기"><a href="#레스토랑-예약-사이트-만들기" class="headerlink" title="레스토랑 예약 사이트 만들기"></a>레스토랑 예약 사이트 만들기</h3><h4 id="35-가게-목록-필터링"><a href="#35-가게-목록-필터링" class="headerlink" title="35. 가게 목록 필터링"></a>35. 가게 목록 필터링</h4><p>필터링 (지역, 분류 (Region, Category))</p>
<p>Region과 Category를 도메인 모델로 관리</p>
<ul>
<li><p>eatgo-admin-api<br>GET /regions<br>POST /regions<br>GET /categories<br>POST /categories  </p>
</li>
<li><p>eatgo-customer-api<br>GET /regions<br>GET /categories  </p>
</li>
</ul>
<p>JPA<br>findAllByAddressContaining<br>findAllByAddressStartingWith  </p>
<p>H2 Console<br><a href="http://localhost:8080/h2-console" target="_blank" rel="noopener">http://localhost:8080/h2-console</a> 에서 h2DB를 관리할 수 있다.  </p>
<p>eatgo-customer-api<br>Restaurant Controller 수정</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@GetMapping(&quot;&#x2F;restaurants&quot;)</span><br><span class="line">public List&lt;Restaurant&gt; list(</span><br><span class="line">        @RequestParam(&quot;region&quot;) String region, &#x2F;&#x2F;region 파라미터 추가</span><br><span class="line">        @RequestParam(&quot;category&quot;) Long categoryId &#x2F;&#x2F;category 파라미터 추가 </span><br><span class="line">) &#123;</span><br><span class="line">    List&lt;Restaurant&gt; restaurants &#x3D; restaurantService.getRestaurants(region,categoryId);</span><br><span class="line">    return restaurants;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Restaurant Service의 getRestaurants 메서드 매개변수 추가 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;Restaurant&gt; getRestaurants(String region, long categoryId) &#123;</span><br><span class="line">    List&lt;Restaurant&gt; restaurants &#x3D;</span><br><span class="line">            restaurantRepository.findByAddressContainingAndCategoryId(region,categoryId);</span><br><span class="line">            &#x2F;&#x2F;입력받은 region을 포함하는 address &#x2F; 일치하는 categoryId </span><br><span class="line">    return restaurants;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Restaurant Repository JPA</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Restaurant&gt; findByAddressContainingAndCategoryId(</span><br><span class="line">        String region, long categoryId);</span><br></pre></td></tr></table></figure>

<p>TEST</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http GET "localhost:8080/restaurants?region=서울&amp;category=1"</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rockintuna.github.io/2020/08/12/hexo_springboot_1_41/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jeong In">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="소문난">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/12/hexo_springboot_1_41/" class="post-title-link" itemprop="url">41. 사용자 관리</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-12 21:22:41" itemprop="dateCreated datePublished" datetime="2020-08-12T21:22:41+09:00">2020-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/" itemprop="url" rel="index"><span itemprop="name">Study</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study/Spring-Boot-Project/" itemprop="url" rel="index"><span itemprop="name">Spring Boot Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="스프링-부트-프로젝트"><a href="#스프링-부트-프로젝트" class="headerlink" title="스프링 부트 프로젝트"></a>스프링 부트 프로젝트</h1><h3 id="레스토랑-예약-사이트-만들기"><a href="#레스토랑-예약-사이트-만들기" class="headerlink" title="레스토랑 예약 사이트 만들기"></a>레스토랑 예약 사이트 만들기</h3><h4 id="41-사용자-관리"><a href="#41-사용자-관리" class="headerlink" title="41. 사용자 관리"></a>41. 사용자 관리</h4><p>User 도메인 모델을 추가할것이다.<br>User의 속성<br>String name<br>Integer level : 1일반고객,2가게,100관리자,0deactive계정…<br>String email</p>
<p>User model</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">@Builder</span><br><span class="line">@Getter</span><br><span class="line">@AllArgsConstructor</span><br><span class="line">@NoArgsConstructor</span><br><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue</span><br><span class="line">    Long id;</span><br><span class="line"></span><br><span class="line">    @NotEmpty</span><br><span class="line">    @Setter</span><br><span class="line">    String email;</span><br><span class="line"></span><br><span class="line">    @NotEmpty</span><br><span class="line">    @Setter</span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    @NotNull</span><br><span class="line">    @Setter</span><br><span class="line">    Long level;</span><br><span class="line"></span><br><span class="line">    public boolean isAdmin() &#123;</span><br><span class="line">        return level &gt;&#x3D; 100;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public boolean isActive() &#123;</span><br><span class="line">        return level &gt; 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void deactivate() &#123;</span><br><span class="line">        level &#x3D; 0L;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Controller에 실제 계정을 제거하는 대신 deactive하는 기능구현  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void delete() throws Exception &#123;</span><br><span class="line">    mvc.perform(MockMvcRequestBuilders.delete(&quot;&#x2F;users&#x2F;1004&quot;))</span><br><span class="line">            .andExpect(status().isOk());</span><br><span class="line"></span><br><span class="line">    Long id &#x3D; 1004L;</span><br><span class="line">    verify(userService).deactiveUser(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Service  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">@Transactional &#x2F;&#x2F;DB에 Transaction처리를 위함이다</span><br><span class="line">               &#x2F;&#x2F;안해주면 update&#x2F;delete 안되었음</span><br><span class="line">public class UserService &#123;</span><br><span class="line"></span><br><span class="line">~</span><br><span class="line"></span><br><span class="line">    public User updateUser(Long id, String email, String name, Long level) &#123;</span><br><span class="line">        &#x2F;&#x2F;TODO 예외처리 추가 필요</span><br><span class="line">        User user &#x3D; userRepository.findById(id).orElse(null);</span><br><span class="line">        user.setEmail(email);</span><br><span class="line">        user.setName(name);</span><br><span class="line">        user.setLevel(level);</span><br><span class="line">        return user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public User deactiveUser(Long id) &#123;</span><br><span class="line">        User user &#x3D; userRepository.findById(id).orElse(null);</span><br><span class="line">        user.deactivate();</span><br><span class="line">        return user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>패스워드, 회원가입등은 추후 추가 예정   </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jeong In</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">95</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jeong In</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
